# DarkCall — чёрный минимализм + чат

Добавлен **чат** с системными событиями: «звонок начался», «звонок завершён (длительность)», плюс обычные текстовые сообщения. Чат открывается кнопкой **«Чат»** на экране звонка.

## Быстрый старт

1) В `firebase-config.js` вставь свой конфиг Firebase (Firestore + Anonymous Auth).  
2) Запусти локальный сервер:
```bash
python -m http.server 8080
```
3) Открой `http://localhost:8080`. Создай комнату и поделись ссылкой.

## Как это работает

- Сообщения и системные события пишутся в `rooms/{roomId}/messages`.  
- «Начал звонок» отправляет **создатель комнаты** при установлении `RTCPeerConnection` (состояние `connected`).  
- «Завершил» отправляется при нажатии **Завершить** или при разрыве соединения; длительность считается на клиенте.  
- Комната после завершения **не удаляется**, чтобы история чата сохранилась (ставится `endedAt`).

## TURN

Чтобы обходить жёсткие NAT/фаерволы, добавь TURN в `app.js → rtcConfig.iceServers` (пример строк есть в коде).

